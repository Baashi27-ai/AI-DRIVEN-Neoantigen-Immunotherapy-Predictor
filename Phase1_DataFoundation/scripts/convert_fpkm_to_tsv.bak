# scripts/convert_fpkm_to_tsv.py
# Converts GEO Excel (FPKM) to TSV. No changes to content, just format.

import pandas as pd
from pathlib import Path

# paths relative to this script
root = Path(_file_).resolve().parents[1]  # Phase1_DataFoundation/
infile = root / "raw" / "GSE78220_PatientFPKM.xlsx"
outfile = root / "expression" / "expression_matrix.tsv"

print(f"Reading: {infile}")
df = pd.read_excel(infile, engine="openpyxl")

# tidy column names (trim spaces)
df.columns = [str(c).strip() for c in df.columns]

# write TSV (tab-separated)
outfile.parent.mkdir(parents=True, exist_ok=True)
df.to_csv(outfile, sep="\t", index=False)
print(f"Saved TSV -> {outfile}")
